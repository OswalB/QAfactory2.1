<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.2/xlsx.full.min.js"></script>

<!-- botones editor de PDF -->
<div style="display: flex; align-items: center;">
  <select id="in-template" class="form-select" style="margin-right: 10px; display:none"></select>
  <button id="btnVerpdf" type="button" class="btn btn-success"
    style="margin-right: 10px;  display:none">Generar</button>
  <button id="btnEditarTemplate" type="button" class="btn btn-danger" style=" display:none">Editar</button>
  <button id="btnGuardarTemplate" type="button" class="btn btn-danger" style=" display:none">Guardar</button>
</div>

<!-- formulario editor de plantillas PDF -->
<div class="container mt-4" id="formDesign" style="display: none;">
  <div class="row">
    <!-- Columna 1: Acordeón design PDF-->
    <div class="col-md-8">
      <div class="scrollable">

        <div class="accordion" id="accordionDesign">
          <div class="accordion-item">
            <h2 class="accordion-header" id="heading1">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#collapse1" aria-expanded="false" aria-controls="collapse1">
                Configuración
              </button>
            </h2>
            <div id="collapse1" class="accordion-collapse collapse" aria-labelledby="heading1"
              data-bs-parent="#accordionDesign">
              <div class="accordion-body">
                <h5>Datos</h5>
                <div class="input-group">
                  <input type="text" class="form-control" name="fieldFilter" id="in-fieldFilter" value=""
                    data-section="pagina">
                  <button type="button" class="btn btn-outline-secondary">Add. Filtro</button>
                  <button type="button" class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-split"
                    data-bs-toggle="dropdown" aria-expanded="false">
                    <span class="visually-hidden">Toggle Dropdown</span>
                  </button>
                  <ul id="listFilterData" class="dropdown-menu dropdown-menu-end">
                  </ul>
                </div>
                <div class="input-group mt-2">
                  <input type="text" class="form-control" name="fieldOrder" id="in-fieldOrder" value=""
                    data-section="pagina">
                  <button type="button" class="btn btn-outline-secondary">Add. Orden</button>
                  <button type="button" class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-split"
                    data-bs-toggle="dropdown" aria-expanded="false">
                    <span class="visually-hidden">Toggle Dropdown</span>
                  </button>
                  <ul id="listOrderData" class="dropdown-menu dropdown-menu-end">
                  </ul>
                </div>
                <div class="input-group mt-2">
                  <input type="text" class="form-control" name="fieldGroup" id="in-fieldGroup" value=""
                    data-section="pagina">
                  <button type="button" class="btn btn-outline-secondary">Add. Grupo</button>
                  <button type="button" class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-split"
                    data-bs-toggle="dropdown" aria-expanded="false">
                    <span class="visually-hidden">Toggle Dropdown</span>
                  </button>
                  <ul id="listGroupData" class="dropdown-menu dropdown-menu-end">
                  </ul>
                </div>
                <hr>
                <h5>Tabla</h5>
                <label for="tableStyle">Estilo:</label>
                <select id="tableStyle" name="tableStyle" class="form-select" data-section="pagina">
                  <option value="" selected>Ninguno</option>
                  <option value='{"bgTitle": "#616161", "txtTitle": "#ffffff", "bgDark": "#e0e0e0", "bgLight":"#f5f5f5", "txtCell":"#000000"}'>GREY</option>
                  <option value='{"bgTitle": "#b71c1c", "txtTitle": "#ffffff", "bgDark": "#ffcdd2", "bgLight":"#ffebee", "txtCell":"#000000"}'>RED</option>
                  <option value='{"bgTitle": "#ec407a", "txtTitle": "#ffffff", "bgDark": "#f8bbd0", "bgLight":"#fce4ec", "txtCell":"#000000"}'>PINK</option>
                  <option value='{"bgTitle": "#ab47bc", "txtTitle": "#ffffff", "bgDark": "#e1bee7", "bgLight":"#f3e5f5", "txtCell":"#000000"}'>PURPLE</option>
                  <option value='{"bgTitle": "#673ab7", "txtTitle": "#ffffff", "bgDark": "#d1c4e9", "bgLight":"#ede7f6", "txtCell":"#000000"}'>Deep purple</option>
                  <option value='{"bgTitle": "#3f51b5", "txtTitle": "#ffffff", "bgDark": "#c5cae9", "bgLight":"#e8eaf6", "txtCell":"#000000"}'>Indigo</option>
                  <option value='{"bgTitle": "#2e86c1", "txtTitle": "#ffffff", "bgDark": "#e3f2fd", "bgLight":"#ffffff", "txtCell":"#000000"}'>BLUE</option>
                  <option value='{"bgTitle": "#00bcd4", "txtTitle": "#ffffff", "bgDark": "#b2ebf2", "bgLight":"#e0f7fa", "txtCell":"#000000"}'>CYAN</option>
                  <option value='{"bgTitle": "#009688", "txtTitle": "#ffffff", "bgDark": "#b2dfdb", "bgLight":"#e0f2f1", "txtCell":"#000000"}'>TEAL</option>
                  <option value='{"bgTitle": "#388e3c", "txtTitle": "#ffffff", "bgDark": "#c8e6c9", "bgLight":"#e8f5e9", "txtCell":"#000000"}'>GREEN</option>
                  <option value='{"bgTitle": "#7cb342", "txtTitle": "#ffffff", "bgDark": "#dcedc8", "bgLight":"#dcedc8", "txtCell":"#000000"}'>Light green</option>
                  <option value='{"bgTitle": "#9e9d24", "txtTitle": "#ffffff", "bgDark": "#f0f4c3", "bgLight":"#f9fbe7", "txtCell":"#000000"}'>LIME</option>
                  <option value='{"bgTitle": "#fdd835", "txtTitle": "#3e2723", "bgDark": "#fff9c4", "bgLight":"#fffde7", "txtCell":"#3e2723"}'>YELLOW</option>
                  <option value='{"bgTitle": "#ef6c00", "txtTitle": "#ffffff", "bgDark": "#ffe0b2", "bgLight":"#fff3e0", "txtCell":"#000000"}'>ORANGE</option>
                  <option value='{"bgTitle": "#795548", "txtTitle": "#ffffff", "bgDark": "#d7ccc8", "bgLight":"#efebe9", "txtCell":"#000000"}'>BROWN</option>
                  
                </select>
                <hr>
                <h5>Pagina</h5>
                <label for="pageSize">Tamaño:</label>
                <select id="pageSize" name="size" class="form-select" data-section="pagina">
                  <option value="letter" selected>Letter (216 x 279 mm)</option>
                  <option value="folio">Folio (216 x 330 mm)</option>
                  <option value="half-letter">Half Letter (140 x 216 mm)</option>
                  <option value="legal">Legal (216 x 356 mm)</option>
                  <option value="ledger">Ledger (279 x 432 mm)</option>
                  <option value="tabloid">Tabloid (279 x 432 mm)</option>
                  <option value="executive">Executive (184 x 267 mm)</option>
                  <option value="a0">A0 (841 x 1189 mm)</option>
                  <option value="a1">A1 (594 x 841 mm)</option>
                  <option value="a2">A2 (420 x 594 mm)</option>
                  <option value="a3">A3 (297 x 420 mm)</option>
                  <option value="a4">A4 (210 x 297 mm)</option>
                  <option value="a5">A5 (148 x 210 mm)</option>
                  <option value="a6">A6 (105 x 148 mm)</option>
                  <option value="a7">A7 (74 x 105 mm)</option>
                  <option value="a8">A8 (52 x 74 mm)</option>
                  <option value="a9">A9 (37 x 52 mm)</option>
                  <option value="a10">A10 (26 x 37 mm)</option>
                  <option value="b0">B0 (1000 x 1414 mm)</option>
                  <option value="b1">B1 (707 x 1000 mm)</option>
                  <option value="b2">B2 (500 x 707 mm)</option>
                  <option value="b3">B3 (353 x 500 mm)</option>
                  <option value="b4">B4 (250 x 353 mm)</option>
                  <option value="b5">B5 (176 x 250 mm)</option>
                  <option value="b6">B6 (125 x 176 mm)</option>
                  <option value="b7">B7 (88 x 125 mm)</option>
                  <option value="b8">B8 (62 x 88 mm)</option>
                  <option value="b9">B9 (44 x 62 mm)</option>
                  <option value="b10">B10 (31 x 44 mm)</option>
                  <option value="c0">C0 (917 x 1297 mm)</option>
                  <option value="c1">C1 (648 x 917 mm)</option>
                  <option value="c2">C2 (458 x 648 mm)</option>
                  <option value="c3">C3 (324 x 458 mm)</option>
                  <option value="c4">C4 (229 x 324 mm)</option>
                  <option value="c5">C5 (162 x 229 mm)</option>
                  <option value="c6">C6 (114 x 162 mm)</option>
                  <option value="c7">C7 (81 x 114 mm)</option>
                  <option value="c8">C8 (57 x 81 mm)</option>
                  <option value="c9">C9 (40 x 57 mm)</option>
                  <option value="c10">C10 (28 x 40 mm)</option>
                  <option value="dl">DL (110 x 220 mm)</option>
                </select>
                <label for="pageOrientation">Orientación:</label>
                <select id="pageOrientation" name="orientation" class="form-select" data-section="pagina">
                  <option value="p" selected>Vertical</option>
                  <option value="l">Horizontal</option>
                </select>
                <label for="" class="mt-4">Márgenes:</label>
                <div class="input-group mb-3">
                  <span class="input-group-text" id="basic-addon2">Izq.</span>
                  <input type="number" class="form-control" name="ml" id="in-ml" value="18" data-section="pagina">
                  <span class="input-group-text" id="basic-addon2">Der.</span>
                  <input type="number" class="form-control" name="mr" id="in-mr" value="18" data-section="pagina">
                </div>
                <div class="input-group mb-3">
                  <span class="input-group-text" id="basic-addon2">Sup.</span>
                  <input type="number" class="form-control" name="mt" id="in-mt" value="19" data-section="pagina">
                  <span class="input-group-text" id="basic-addon2">Der.</span>
                  <input type="number" class="form-control" name="mb" id="in-mb" value="19" data-section="pagina">
                </div>
                <label for="pagination">Paginación:</label>
                <select id="pagination" name="pagination" class="form-select" data-section="pagina">
                  <option value="0">Ninguno</option>
                  <option value="1" selected>Centro Página 1</option>
                  <option value="2">Centro Página 1 de...</option>
                  <option value="3">Borde Página 1</option>
                  <option value="4">Borde Página 1 de...</option>
                </select>
              </div>
            </div>
          </div>
          <!-- secciones: Encabezado REPORTE-->
          <div class="accordion-item">
            <h2 class="accordion-header" id="heading2">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#collapse2" aria-expanded="false" aria-controls="collapse2">
                Encabezado de informe
              </button>
            </h2>
            <div id="collapse2" class="accordion-collapse collapse" aria-labelledby="heading2"
              data-bs-parent="#accordionDesign">
              <div class="accordion-body">
                <div id="acc-headerReport">

                </div>
                <div class="row mt-2" style="width: 100%;">
                  <div class="col-8">
                    <a data-section="headerReport" role="addSection" class="btn btn-success w-100" href="#">
                      <i data-section="headerReport" role="addSection" class="fa fa-plus-square"></i> Add
                    </a>
                  </div>
                  <div class="col-4">
                    <a data-section="headerReport" role="delSection" class="btn btn-danger w-100" href="#">
                      <i data-section="headerReport" role="delSection" class="fa fa-trash"></i>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- secciones: Encabezado PAGINA-->
          <div class="accordion-item">
            <h2 class="accordion-header" id="heading3">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#collapse3" aria-expanded="false" aria-controls="collapse3">
                Encabezado de página
              </button>
            </h2>
            <div id="collapse3" class="accordion-collapse collapse" aria-labelledby="heading3"
              data-bs-parent="#accordionDesign">
              <div class="accordion-body">
                <div id="acc-headerPage">

                </div>
                <div class="row mt-2" style="width: 100%;">
                  <div class="col-8">
                    <a data-section="headerPage" role="addSection" class="btn btn-success w-100" href="#">
                      <i data-section="headerPage" role="addSection" class="fa fa-plus-square"></i> Add
                    </a>
                  </div>
                  <div class="col-4">
                    <a data-section="headerPage" role="delSection" class="btn btn-danger w-100" href="#">
                      <i data-section="headerPage" role="delSection" class="fa fa-trash"></i>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- secciones: Encabezado GRUPO-->
          <div class="accordion-item">
            <h2 class="accordion-header" id="heading4">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#collapse4" aria-expanded="false" aria-controls="collapse4">
                Encabezado de grupo de datos
              </button>
            </h2>
            <div id="collapse4" class="accordion-collapse collapse" aria-labelledby="heading4"
              data-bs-parent="#accordionDesign">
              <div class="accordion-body">
                <div id="acc-headerGroup">

                </div>
                <div class="row mt-2" style="width: 100%;">
                  <div class="col-8">
                    <a data-section="headerGroup" role="addSection" class="btn btn-success w-100" href="#">
                      <i data-section="headerGroup" role="addSection" class="fa fa-plus-square"></i> Add
                    </a>
                  </div>
                  <div class="col-4">
                    <a data-section="headerGroup" role="delSection" class="btn btn-danger w-100" href="#">
                      <i data-section="headerGroup" role="delSection" class="fa fa-trash"></i>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- secciones: Encabezado DETALLE-->
          <div class="accordion-item">
            <h2 class="accordion-header" id="heading5">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#collapse5" aria-expanded="false" aria-controls="collapse5">
                Encabezado de grupo de detalle
              </button>
            </h2>
            <div id="collapse5" class="accordion-collapse collapse" aria-labelledby="heading5"
              data-bs-parent="#accordionDesign">
              <div class="accordion-body">
                <div id="acc-headerDetail">

                </div>
                <div class="row mt-2" style="width: 100%;">
                  <div class="col-8">
                    <a data-section="headerDetail" role="addSection" class="btn btn-success w-100" href="#">
                      <i data-section="headerDetail" role="addSection" class="fa fa-plus-square"></i> Add
                    </a>
                  </div>
                  <div class="col-4">
                    <a data-section="headerDetail" role="delSection" class="btn btn-danger w-100" href="#">
                      <i data-section="headerDetail" role="delSection" class="fa fa-trash"></i>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- secciones: DETALLE detalle-->
          <div class="accordion-item">
            <h2 class="accordion-header" id="heading6">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#collapse6" aria-expanded="false" aria-controls="collapse6">
                DETALLE
              </button>
            </h2>
            <div id="collapse6" class="accordion-collapse collapse" aria-labelledby="heading6"
              data-bs-parent="#accordionDesign">
              <div class="accordion-body">
                <div id="acc-detail">

                </div>
                <div class="row mt-2" style="width: 100%;">
                  <div class="col-8">
                    <a data-section="detail" role="addSection" class="btn btn-success w-100" href="#">
                      <i data-section="detail" role="addSection" class="fa fa-plus-square"></i> Add
                    </a>
                  </div>
                  <div class="col-4">
                    <a data-section="detail" role="delSection" class="btn btn-danger w-100" href="#">
                      <i data-section="detail" role="delSection" class="fa fa-trash"></i>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- secciones: footer DETALLE -->
          <div class="accordion-item">
            <h2 class="accordion-header" id="heading7">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#collapse7" aria-expanded="false" aria-controls="collapse7">
                Pié de detalle
              </button>
            </h2>
            <div id="collapse7" class="accordion-collapse collapse" aria-labelledby="heading7"
              data-bs-parent="#accordionDesign">
              <div class="accordion-body">
                <div id="acc-footerDetail">

                </div>
                <div class="row mt-2" style="width: 100%;">
                  <div class="col-8">
                    <a data-section="footerDetail" role="addSection" class="btn btn-success w-100" href="#">
                      <i data-section="footerDetail" role="addSection" class="fa fa-plus-square"></i> Add
                    </a>
                  </div>
                  <div class="col-4">
                    <a data-section="footerDetail" role="delSection" class="btn btn-danger w-100" href="#">
                      <i data-section="footerDetail" role="delSection" class="fa fa-trash"></i>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- secciones: footer GRUPO -->
          <div class="accordion-item">
            <h2 class="accordion-header" id="heading8">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#collapse8" aria-expanded="false" aria-controls="collapse8">
                Pié de grupo
              </button>
            </h2>
            <div id="collapse8" class="accordion-collapse collapse" aria-labelledby="heading8"
              data-bs-parent="#accordionDesign">
              <div class="accordion-body">
                <div id="acc-footerGroup">

                </div>
                <div class="row mt-2" style="width: 100%;">
                  <div class="col-8">
                    <a data-section="footerGroup" role="addSection" class="btn btn-success w-100" href="#">
                      <i data-section="footerGroup" role="addSection" class="fa fa-plus-square"></i> Add
                    </a>
                  </div>
                  <div class="col-4">
                    <a data-section="footerGroup" role="delSection" class="btn btn-danger w-100" href="#">
                      <i data-section="footerGroup" role="delSection" class="fa fa-trash"></i>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- secciones: footer Reporte -->
          <div class="accordion-item">
            <h2 class="accordion-header" id="heading7">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#collapse9" aria-expanded="false" aria-controls="collapse9">
                Pié de Informe
              </button>
            </h2>
            <div id="collapse9" class="accordion-collapse collapse" aria-labelledby="heading9"
              data-bs-parent="#accordionDesign">
              <div class="accordion-body">
                <div id="acc-footerReport">

                </div>
                <div class="row mt-2" style="width: 100%;">
                  <div class="col-8">
                    <a data-section="footerReport" role="addSection" class="btn btn-success w-100" href="#">
                      <i data-section="footerReport" role="addSection" class="fa fa-plus-square"></i> Add
                    </a>
                  </div>
                  <div class="col-4">
                    <a data-section="footerReport" role="delSection" class="btn btn-danger w-100" href="#">
                      <i data-section="footerReport" role="delSection" class="fa fa-trash"></i>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>



        </div>

      </div>
    </div>
    <!-- Columna 2: properties -->
    <div class="col-md-4 bg-dark bg-opacity-10">
      <div class="scrollable">
        <h5 id="title-properties">titulo</h5>
        <h6>Origen de datos</h6>
        <label for="in-originControl">Campo:</label>
        <select id="in-originControl" name="originControl" class="form-select" role="property">

        </select>
        <label for="in-fxControl">Función:</label>
        <select id="in-fxControl" name="fxControl" class="form-select" role="property">
          <option value="">--</option>
          <option value="sum">Suma</option>
          <option value="av">Promedio</option>
          <option value="min">Mínimo</option>
          <option value="max">Máximo</option>
          <option value="std">Desviación estándar</option>
          <option value="var">Varianza</option>
          <option value="med">Mediana</option>
          <option value="range">Rango</option>
          <option value="moda">Moda</option>
        </select>

        </select>
        <label for="in-formatControl">Formato:</label>
        <select id="in-formatControl" name="formatControl" class="form-select" role="property">
          <option value="">--</option>
          <option value="123">123</option>
          <option value="123.0">123.0</option>
          <option value="123.00">123.00</option>
          <option value="123.000">123.000</option>
          <option value="123.0000">123.0000</option>
          <option value="dd/mm/aa">dd/mm/aa</option>
          <option value="dd/mmm/aa">dd/mmm/aa</option>
          <option value="dd/mmm/aaa">dd/mmm/aaa</option>
          <option value="dd/mmmm/aaa">dd/mmmm/aaa</option>
          <option value="dd/mmm/aaa-00:00">dd/mmm/aaa-00:00</option>
          <option value="hh:mm:ss">hh:mm:ss</option>
          <option value="hh:mm">hh:mm</option>
          <option value="hhh:mm">hhh:mm</option>
          <option value="hhh:mm:ss">hhh:mm:ss</option>
        </select>


        <h6>Fuente</h6>
        <div class="input-group mb-1">
          <span class="input-group-text" id="basic-addon2">Tamaño</span>
          <input type="number" class="form-control text-end" name="sizeFont" id="in-sizeFont" role="property">
        </div>
        <div class="input-group mb-1">
          <span class="input-group-text" id="basic-addon2">Color</span>
          <input type="color" class="form-control" name="colorFont" id="in-colorFont" role="property">
        </div>
        <div class="input-group mb-1 mt-1">
          <span class="input-group-text" for="in-align">Alineación:</span>
          <select id="in-align" name="align" class="form-select" role="property">
            <option value="0" selected>Izquierda</option>
            <option value="1">Centro</option>
            <option value="2">Derecha</option>
          </select>
        </div>
        <h6>Cuadro</h6>
        <div class="input-group mb-1">
          <span class="input-group-text" id="basic-addon2">Ancho(1 a 12)</span>
          <input type="number" class="form-control text-end" name="col" id="in-col" role="property">
        </div>
        <div class="input-group mb-1">
          <span class="input-group-text" id="basic-addon2">Alto</span>
          <input type="number" class="form-control text-end" name="height" id="in-heiht" role="property">
        </div>
        <label class="form-check-label" for="in-siBorde">Borde </label>
        <input type="checkbox" class="form-check-input" name="siBorde" id="in-siBorde" value="" checked role="property">
        <label class="form-check-label" for="in-siBg">Fondo </label>
        <input type="checkbox" class="form-check-input" name="siBg" id="in-siBg" value="" checked role="property">
        <div class="input-group mb-1">
          <span class="input-group-text" id="basic-addon2">Color</span>
          <input type="color" class="form-control" name="colorBg" id="in-colorBg" role="property">
        </div>

        <div class="input-group mb-1">
          <span class="input-group-text" id="basic-addon2">Padding X</span>
          <input type="number" class="form-control text-end" name="paddingX" id="in-paddingX" role="property">
        </div>
        <div class="input-group mb-1">
          <span class="input-group-text" id="basic-addon2">Padding Y</span>
          <input type="number" class="form-control text-end" name="paddingY" id="in-paddingY" role="property">
        </div>
        <div class="">
          <label class="form-check-label" for="in-forceNewRow">Forzar nueva fila </label>
          <input type="checkbox" class="form-check-input ml-4" name="forceNewRow" id="in-forceNewRow" value=""
            role="property">
        </div>
        <div class="">
          <label class="form-check-label" for="in-forceNewPage">Forzar nueva PAGINA </label>
          <input type="checkbox" class="form-check-input ml-4" name="forceNewPage" id="in-forceNewPage" value=""
            role="property">
        </div>






      </div>
    </div>
  </div>
</div>


<table class="table table-success table-striped table-hover">
  <thead>
    <tr id="encabezado">

    </tr>
  </thead>
  <tbody id="bodyContainer">

  </tbody>
</table>

<script src="/js/editor.js"></script>


<script src="/js/pdfmaker.js"></script>
<script type="text/javascript" src="  https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>